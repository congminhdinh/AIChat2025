{
  "project_name": "AIChat2025",
  "generated_date": "2025-12-28",
  "summary": {
    "total_files": 188,
    "total_lines_of_code_estimate": 25000,
    "total_services": 9,
    "total_api_endpoints": 32,
    "total_database_tables": 8
  },
  "backend_dotnet": {
    "framework": ".NET 9.0",
    "total_files": 144,
    "lines_of_code_estimate": 18000,
    "number_of_classes_estimate": 150,
    "number_of_interfaces_estimate": 25,
    "api_endpoints_count": 32,
    "services_count": 7,
    "breakdown_by_service": {
      "ApiGateway": {
        "files": 5,
        "lines_of_code_estimate": 500,
        "classes": 3,
        "purpose": "YARP Reverse Proxy, Swagger Aggregation",
        "technology": ".NET 9, YARP 2.3.0",
        "endpoints": 0,
        "key_files": [
          "Program.cs",
          "Config/appsettings.json"
        ]
      },
      "AccountService": {
        "files": 15,
        "lines_of_code_estimate": 2500,
        "classes": 12,
        "entities": 1,
        "endpoints": 9,
        "purpose": "Authentication, User Management",
        "technology": ".NET 9, EF Core 9, BCrypt",
        "key_files": [
          "Endpoints/AuthEndpoint.cs",
          "Endpoints/AccountEndpoint.cs",
          "Features/AccountBusiness.cs",
          "Entities/Account.cs",
          "Data/AccountDbContext.cs"
        ],
        "api_endpoints": [
          "POST /web-api/account/auth/login",
          "GET /web-api/account/current-user",
          "GET /web-api/account/{id}",
          "GET /web-api/account/list",
          "POST /web-api/account/",
          "POST /web-api/account/admin-account",
          "PUT /web-api/account/change-password",
          "PUT /web-api/account/",
          "POST /web-api/account/tenancy-deactivate"
        ]
      },
      "TenantService": {
        "files": 10,
        "lines_of_code_estimate": 1500,
        "classes": 8,
        "entities": 2,
        "endpoints": 3,
        "purpose": "Multi-tenant Management",
        "technology": ".NET 9, EF Core 9",
        "key_files": [
          "Endpoints/TenantEndpoint.cs",
          "Features/TenantBusiness.cs",
          "Entities/Tenant.cs",
          "Entities/Permission.cs",
          "Data/TenantDbContext.cs"
        ],
        "api_endpoints": [
          "GET /web-api/tenant/list",
          "POST /web-api/tenant/create",
          "GET /web-api/tenant/ok"
        ]
      },
      "DocumentService": {
        "files": 20,
        "lines_of_code_estimate": 3500,
        "classes": 15,
        "entities": 1,
        "endpoints": 7,
        "purpose": "Document Management, Background Vectorization",
        "technology": ".NET 9, EF Core 9, Hangfire 1.8.17, DocumentFormat.OpenXml 3.3.0",
        "key_files": [
          "Endpoints/DocumentEndpoint.cs",
          "Features/PromptDocumentBusiness.cs",
          "Features/VectorizeBackgroundJob.cs",
          "Entities/PromptDocument.cs",
          "Data/DocumentDbContext.cs"
        ],
        "api_endpoints": [
          "GET /web-api/document/{id}",
          "GET /web-api/document/list",
          "POST /web-api/document/",
          "PUT /web-api/document/",
          "DELETE /web-api/document/{id}",
          "POST /web-api/document/vectorize/{documentId}",
          "GET /web-api/document/ok"
        ]
      },
      "StorageService": {
        "files": 8,
        "lines_of_code_estimate": 1200,
        "classes": 5,
        "entities": 0,
        "endpoints": 3,
        "purpose": "File Storage via MinIO (S3-compatible)",
        "technology": ".NET 9, Minio 7.0.0",
        "key_files": [
          "Endpoints/StorageEndpoint.cs",
          "Features/StorageBusiness.cs"
        ],
        "api_endpoints": [
          "POST /web-api/storage/upload",
          "GET /web-api/storage/download",
          "DELETE /web-api/storage/delete"
        ]
      },
      "ChatService": {
        "files": 25,
        "lines_of_code_estimate": 4000,
        "classes": 18,
        "entities": 3,
        "endpoints": 6,
        "signalr_hub": 1,
        "rabbitmq_consumers": 1,
        "purpose": "Chat Management, SignalR Hub, RabbitMQ Integration",
        "technology": ".NET 9, EF Core 9, SignalR 1.1.0, MassTransit 8.3.4",
        "key_files": [
          "Endpoints/ChatEndpoint.cs",
          "Endpoints/PromptConfigEndpoint.cs",
          "Features/ChatBusiness.cs",
          "Hubs/ChatHub.cs",
          "Consumers/BotResponseConsumer.cs",
          "Events/UserPromptReceivedEvent.cs",
          "Events/BotResponseCreatedEvent.cs",
          "Entities/ChatConversation.cs",
          "Entities/ChatMessage.cs",
          "Entities/PromptConfig.cs",
          "Data/ChatDbContext.cs"
        ],
        "api_endpoints": [
          "POST /web-api/chat/conversations",
          "GET /web-api/chat/conversations/list",
          "GET /web-api/chat/conversations/{conversationId}",
          "POST /web-api/chat/messages",
          "GET /web-api/chat/prompt-config/",
          "POST /web-api/chat/prompt-config/",
          "PUT /web-api/chat/prompt-config/{id}",
          "DELETE /web-api/chat/prompt-config/{id}"
        ],
        "signalr_methods": [
          "SendMessage",
          "JoinConversation",
          "LeaveConversation",
          "ReceiveMessage (client)",
          "BotResponse (client)"
        ]
      },
      "WebApp": {
        "files": 16,
        "lines_of_code_estimate": 2800,
        "classes": 8,
        "controllers": 4,
        "razor_views": 11,
        "purpose": "Frontend MVC Application",
        "technology": "ASP.NET Core MVC 9.0, Razor, Cookie Authentication",
        "key_files": [
          "Controllers/AuthController.cs",
          "Controllers/ChatController.cs",
          "Controllers/AccountController.cs",
          "Controllers/HomeController.cs",
          "Views/Auth/Login.cshtml",
          "Views/Chat/Index.cshtml",
          "Views/Account/Index.cshtml",
          "Business/AuthBusiness.cs",
          "Business/ChatBusiness.cs"
        ],
        "controllers_list": [
          "AuthController (login, logout)",
          "ChatController (chat interface, conversations)",
          "AccountController (account management)",
          "HomeController (landing, privacy)"
        ]
      },
      "Infrastructure": {
        "files": 35,
        "lines_of_code_estimate": 4500,
        "classes": 30,
        "interfaces": 15,
        "purpose": "Shared Library (Tenancy, Auth, Database, Specifications)",
        "technology": ".NET 9, EF Core 9, Ardalis.Specification 9.3.1",
        "key_files": [
          "Entities/BaseEntity.cs",
          "Tenancy/CurrentTenantProvider.cs",
          "Authentication/TokenClaimsService.cs",
          "Authentication/TokenDecoder.cs",
          "Web/CurrentUserProvider.cs",
          "Database/BaseDbContext.cs",
          "Database/UpdateTenancyInterceptor.cs",
          "Database/UpdateAuditableInterceptor.cs",
          "Specifications/TenancySpecification.cs",
          "AppSettings.cs"
        ],
        "components": [
          "Multi-tenancy (CurrentTenantProvider, TenancySpecification)",
          "Authentication (JWT generation, validation)",
          "Database (BaseDbContext, Interceptors)",
          "Specifications (Repository patterns)",
          "Extensions (DI registration helpers)"
        ]
      }
    }
  },
  "ai_workers_python": {
    "framework": "FastAPI 0.115.0",
    "total_files": 27,
    "lines_of_code_estimate": 3500,
    "number_of_classes_estimate": 15,
    "workers_count": 2,
    "breakdown": {
      "EmbeddingService": {
        "files": 10,
        "lines_of_code_estimate": 1200,
        "classes": 5,
        "purpose": "Document Embedding, Qdrant Integration",
        "technology": "FastAPI, HuggingFace Transformers, ONNX Runtime, Qdrant Client 1.7.0",
        "model_used": "truro7/vn-law-embedding (768-dimensional)",
        "key_files": [
          "main.py",
          "src/business.py",
          "src/router.py",
          "src/config.py",
          "requirements.txt"
        ],
        "api_endpoints": [
          "POST /embed",
          "POST /vectorize",
          "POST /vectorize-batch",
          "POST /api/embeddings/delete",
          "POST /search",
          "GET /health"
        ],
        "key_components": [
          "EmbeddingService (encode_text, vectorize_batch)",
          "QdrantService (vector storage, search)",
          "FastAPI Router (HTTP endpoints)"
        ]
      },
      "ChatProcessor": {
        "files": 17,
        "lines_of_code_estimate": 2300,
        "classes": 10,
        "purpose": "RAG Pipeline, LLM Integration, RabbitMQ Consumer",
        "technology": "FastAPI, Ollama Client, Qdrant Client 1.11.3, aio-pika 9.4.3, RAGAS",
        "llm_model_used": "ontocord/vistral:latest (Vietnamese-finetuned)",
        "key_files": [
          "main.py",
          "src/business.py",
          "src/consumer.py",
          "src/config.py",
          "app/services/rabbitmq_service.py",
          "app/services/service.py",
          "app/utils/jwt_validator.py",
          "requirements.txt"
        ],
        "key_components": [
          "ChatBusiness (RAG pipeline, 9-step process)",
          "OllamaService (LLM generation)",
          "QdrantService (vector search)",
          "RabbitMQService (message queue consumer)",
          "JWTValidator (cross-platform token validation)",
          "EvaluationLogger (RAGAS metrics)"
        ],
        "rag_pipeline_steps": 9,
        "rabbitmq_queues": [
          "UserPromptReceived (input)",
          "BotResponseCreated (output)"
        ]
      }
    }
  },
  "frontend_mvc": {
    "framework": "ASP.NET MVC with Razor",
    "total_files": 17,
    "lines_of_code_estimate": 2500,
    "razor_views": 11,
    "controllers": 4,
    "javascript_files": 6,
    "css_files": 2,
    "breakdown": {
      "views": {
        "count": 11,
        "files": [
          "_ViewImports.cshtml",
          "_ViewStart.cshtml",
          "Shared/_Layout.cshtml",
          "Shared/_ValidationScriptsPartial.cshtml",
          "Shared/Error.cshtml",
          "Home/Index.cshtml",
          "Home/Privacy.cshtml",
          "Auth/Login.cshtml",
          "Chat/Index.cshtml",
          "Chat/CreateConversationPartial.cshtml",
          "Account/Index.cshtml"
        ]
      },
      "javascript": {
        "count": 6,
        "files": [
          "wwwroot/js/site.js",
          "wwwroot/Scripts/Auth/Login.js",
          "wwwroot/Scripts/Chat/Chat.js"
        ],
        "libraries": [
          "jQuery 3.x",
          "Bootstrap 5",
          "SignalR Client 8.0.0",
          "jQuery Validation",
          "jQuery Validation Unobtrusive"
        ]
      },
      "controllers": {
        "count": 4,
        "files": [
          "Controllers/HomeController.cs",
          "Controllers/AuthController.cs",
          "Controllers/ChatController.cs",
          "Controllers/AccountController.cs"
        ]
      }
    },
    "key_features": [
      "Cookie-based authentication",
      "SignalR real-time chat",
      "Responsive design (Bootstrap 5)",
      "Client-side validation",
      "Async HTTP API calls"
    ]
  },
  "tests": {
    "unit_tests": 0,
    "integration_tests": 0,
    "test_coverage_estimate": "0% (Not implemented yet)",
    "testing_status": "Manual testing only",
    "recommended_test_frameworks": [
      "xUnit (for .NET backend)",
      "pytest (for Python AI workers)",
      "Moq (for mocking in .NET)",
      "Jest (for JavaScript frontend)"
    ],
    "future_testing_plan": {
      "unit_tests_target": 150,
      "integration_tests_target": 50,
      "coverage_target": "70-80%"
    }
  },
  "infrastructure": {
    "docker_compose_services": 13,
    "services_list": [
      "sqlserver",
      "rabbitmq",
      "qdrant",
      "ollama",
      "minio",
      "accountservice",
      "tenantservice",
      "documentservice",
      "storageservice",
      "chatservice",
      "embeddingservice",
      "chatprocessor",
      "apigateway"
    ],
    "database": {
      "type": "SQL Server 2022",
      "database_name": "AIChat2025",
      "tables_count": 8,
      "migrations_count": 12,
      "entities": [
        "Account",
        "Tenant",
        "Permission",
        "ChatConversation",
        "ChatMessage",
        "PromptConfig",
        "PromptDocument"
      ]
    },
    "rabbitmq": {
      "queues_count": 2,
      "queues": [
        "UserPromptReceived",
        "BotResponseCreated"
      ],
      "exchanges_count": 2,
      "exchange_type": "Fanout"
    },
    "qdrant": {
      "collections_count": 1,
      "collections": [
        "vn_law_documents"
      ],
      "vector_dimension": 768,
      "distance_metric": "COSINE"
    },
    "minio": {
      "buckets_count": 1,
      "buckets": [
        "ai-chat-2025"
      ],
      "storage_type": "S3-compatible object storage"
    },
    "ollama": {
      "models_count": 1,
      "models": [
        "ontocord/vistral:latest"
      ],
      "purpose": "Local LLM inference for Vietnamese"
    }
  },
  "api_summary": {
    "total_rest_endpoints": 32,
    "total_signalr_hubs": 1,
    "total_signalr_methods": 3,
    "total_rabbitmq_events": 2,
    "authentication_method": "JWT Bearer + Cookie",
    "authorization_policies": [
      "scope_web",
      "scope_mobile",
      "admin_policy"
    ]
  },
  "deployment": {
    "containerization": "Docker Compose",
    "network_mode": "Bridge (aichat-network)",
    "volumes_count": 3,
    "volumes": [
      "G:/Mount/qdrant",
      "G:/Mount/ollama",
      "G:/Mount/minio"
    ],
    "port_mappings": {
      "apigateway": "5000:8080",
      "accountservice": "5050:8080",
      "tenantservice": "5062:8080",
      "documentservice": "5165:8080",
      "storageservice": "5113:8080",
      "chatservice": "5218:8080",
      "embeddingservice": "8000:8000",
      "chatprocessor": "8001:8001",
      "sqlserver": "1433:1433",
      "rabbitmq": "5672:5672, 15672:15672",
      "qdrant": "6333:6333",
      "ollama": "11434:11434",
      "minio": "9000:9000, 9001:9001"
    }
  },
  "code_quality_metrics": {
    "estimated_cyclomatic_complexity": "Medium (5-10 average)",
    "architectural_patterns": [
      "Microservices",
      "Repository Pattern",
      "Specification Pattern",
      "CQRS Lite",
      "Event-Driven Architecture",
      "Domain-Driven Design"
    ],
    "code_smells_identified": [
      "Hardcoded JWT secret key (security issue)",
      "No unit tests (testability issue)",
      "Some God classes in Business layers (SRP violation)",
      "Missing interfaces in some services (DIP violation)"
    ],
    "technical_debt_estimate": "Low to Medium"
  },
  "documentation": {
    "inline_code_comments": "Sparse (needs improvement)",
    "xml_documentation": "Minimal",
    "readme_files": 1,
    "api_documentation": "Swagger/OpenAPI (auto-generated)",
    "architecture_documentation": "System Analysis Report (25,000+ words)"
  }
}
