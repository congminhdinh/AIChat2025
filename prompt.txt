Task: Implement Frontend Logic (Flow 1 & Flow 2) for the Chat Module.

Context: I need to finalize the JavaScript logic in wwwroot/Scripts/Chat/Chat.js and the corresponding actions in ChatController.cs. We are focusing only on the read flows right now:

Flow 1 (Initialization): Loading the conversation list on page load & automatically opening the most recent one.

Flow 2 (Navigation): Clicking a conversation in the sidebar to load its message history.

Files to Modify:

wwwroot/Scripts/Chat/Chat.js

WebApp/Controllers/ChatController.cs

WebApp/Views/Chat/Index.cshtml (Reference only, for DOM selectors).

Detailed Requirements:

A. ChatController (ChatController.cs)

Ensure there are two HttpGet actions returning JsonResult:

GetConversations(): Returns a list of conversations (Id, Title, Date).

GetHistory(int id): Returns the message list for a specific conversation.

Constraint: These actions must call the ChatBusiness (which calls the Microservice) and map the data to a JSON-friendly format.

B. Chat.js (wwwroot/Scripts/Chat/Chat.js)

1. Initialization Logic ($(document).ready):

Call GetConversations.

Render the list into the sidebar (.history-list).

Crucial: If the list is not empty, automatically trigger the loading of the first conversation in the list (Simulate a click or call the load function directly).

2. Sidebar Interaction:

Handle click events on .history-item.

Add/Remove the .active class to highlight the selected conversation.

Call loadChatHistory(id).

3. Rendering Logic (loadChatHistory):

Call GetHistory.

Clear the main chat area (.chat-content).

Loop through messages and render them based on Type:

Type 1 (Bot): Use HTML structure with class .message.bot and avatar âœ¨.

Type 0 (User): Use HTML structure with class .message.user and avatar ðŸ‘¤.

Reference: Use the "Gemini-style" HTML structure discussed previously (Avatar, Message Bubble).

Constraint:

Scan the Index.cshtml structure (mentally or from previous context) to ensure your jQuery selectors (e.g., .history-list, .chat-content, .history-item) match the HTML exactly.

Do not implement the "Send Message" logic yet. Focus strictly on data loading and rendering.