This is the specialized prompt for Claude, integrating the UIShareLogic.txt standards with your specific feedback workflow. It clearly separates the "Quick Rate" logic from the "Detailed Comment" modal.

Prompt for Claude
Role: Senior .NET Fullstack Developer

Task: Implement the Chat Feedback workflow in the WebApp project.

1. General Standards & Logic Reference

Primary Logic: Strictly follow the Partial Injection and AJAX Loop patterns defined in UIShareLogic.txt.

Feedback Mechanism: Implement a two-tier system: Independent Quick Rating (on the Chat Index) and Detailed Feedback (via Modal).

2. Step 1: Quick Rating (Index View)

Location: Under each Bot response.

Icons: Like (Ratings = 1) and Dislike (Ratings = 2).

Trigger: On click, immediately call POST /chat/chat-feedback/rate with { MessageId: int, Ratings: int }.

UI Feedback: Toggle icon color/fill based on the response. No modal is triggered here.

3. Step 2: Detailed Feedback Modal (Partial View)

Trigger: Clicking the "Comment" icon under a Bot response.

Initialization: * Call GET /chat/chat-feedback/{id} (where {id} is the MessageId) to fetch current feedback data.

Use the returned data to populate the modal.

Modal UI (To be generated by Claude):

Create a Partial View _ChatFeedbackModal.cshtml.

Fields:

Category: A dropdown menu containing the following Vietnamese labels:

WrongKnowledge: "Sai kiến thức pháp luật"

OutdatedInfo: "Thông tin hết hiệu lực"

ConflictingInfo: "Câu trả lời mâu thuẫn"

Misunderstood: "Hiểu sai ý người dùng"

WrongCitation: "Trích dẫn sai nguồn"

MissingLegalBasis: "Thiếu căn cứ pháp lý"

IrrelevantSource: "Nguồn không liên quan"

TooVerbose: "Trả lời quá lan man"

TooBrief: "Trả lời quá sơ sài"

SlowResponse: "Phản hồi quá chậm"

FormattingError: "Lỗi hiển thị/Định dạng"

Other: "Khác"

Content: A textarea for the detailed remark.

Exclusion: DO NOT include Like/Dislike buttons inside this modal.

Action:

If data exists (Category is not Initialized): Treat as an Update (PUT /chat/chat-feedback/{id}).

If data is new/initialized: Treat as Create/Enrich (POST /chat/chat-feedback/).

4. Scripting & UX (chat.js)

Use Event Delegation to catch clicks on bot response icons.

Modal Logic: Inject the Partial View into #modal-content-container and show #modal-overlay.

UX Guardrails: * Show a loading spinner during AJAX requests.

Auto-focus the textarea with a 100ms delay.

Use Toastr for success/error notifications.

5. Backend Integration

Ensure all JSON payloads match the PascalCase naming convention of the .NET DTOs.

Handle the BaseResponse wrapper correctly when processing results.