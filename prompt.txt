Role: Expert .NET Fullstack Developer Task: System-wide UI Refactoring with Dynamic WebAppUrl Configuration & RBAC. Update the WebApp project:

1. Technical Abstract Unify the UI architecture of the AIChat2025 system using a centralized _Layout.cshtml. The system must move away from relative paths (~/) for assets and navigation. Instead, it must use a Strongly Typed Configuration approach by injecting the AppSettings class (from the Infrastructure layer) to prepend a global WebAppUrl to all static files and routing paths.

2. Strongly Typed Configuration Integration

Infrastructure Access: In _Layout.cshtml, inject the AppSettings using: @inject Microsoft.Extensions.Options.IOptions<Infrastructure.AppSettings> AppSettingsOptions

Global Variable: Define a local variable @{ var webAppUrl = AppSettingsOptions.Value.WebAppUrl; } at the top of the layout.

Asset Path Refactoring: All <script>, <link>, and <img> tags must use this prefix.

Example: <script src="@(webAppUrl)/Scripts/Document/document.js" asp-append-version="true"></script>

Link Refactoring: Apply the same logic to the href attributes in the navigation bar.

3. Header & Routing Definition Update the Header with the following mapping (all prefixed with webAppUrl):

Chat: /Chat

Tài liệu: /Document

Tài khoản: /Account (Renamed from Quản lý Account)

Cấu hình: /SystemPrompt

Thuật ngữ: /PromptConfig (New Tab)

Thống kê: /Stat (New Tab)

4. Layout & Assets Refactoring

Unified Header: Integrate a responsive Bootstrap header with the navigation mapping above.

Assets: Include CSS/JS libraries from the Document/Index view (SweetAlert2, Toastr, Bootstrap). Ensure no duplication between Layout and Child views.

Dynamic Active State: Implement logic to add the active class to the current navigation item based on the Request path.

View Integration:

Remove Layout = null; from Chat/Index.cshtml and Document/Index.cshtml.

Utilize @RenderBody() and @RenderSection("Scripts", required: false).

5. Permission Helper (RBAC) Implementation Use the IdentityHelper class to control visibility:

If IdentityHelper.IsAdmin == true: Show all 6 tabs (Chat, Tài liệu, Tài khoản, Cấu hình, Thuật ngữ, Thống kê).

If IdentityHelper.IsAdmin == false: Show ONLY the "Chat" tab.

Logic: Wrap <li> elements in @if (IdentityHelper.IsAdmin) { ... }.

6. Detailed Quality Requirements:

Date Formatting: In the Document list, format LastModifiedAt as dd/MM/yyyy HH:mm. Hide the field if the value is null.

Environment Badge: Add a small badge in the footer indicating if the app is running in "Development" vs "Production" (via IConfiguration).

Global JS Variables: In the <head>, initialize a global JS variable const WEB_APP_URL = '@webAppUrl'; so external JS files can also use the base path for AJAX calls.

Source Files for Modification:

_Layout.cshtml

Document/Index.cshtml

Chat/Index.cshtml

IdentityHelper.cs

Infrastructure/AppSettings.cs (The class containing the WebAppUrl property)

appsettings.Development.json