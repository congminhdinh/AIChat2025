Objective: Integrate a multi-tenant System Prompt (Behavioral Instruction) feature into the "AIChat2025" RAG pipeline, ensuring it complements the existing vector-based retrieval.

Key Tasks & Architectural Guidance:

Data Modeling (ChatService - .NET):

Define a new entity SystemPrompt that inherits from our TenancyEntity.

This entity should store the persona and behavioral guidelines unique to each tenant.

Determine the best way to handle "Active" prompts within the multi-tenant context (e.g., one active prompt per tenant/bot).

Service Communication (Message Contract):

Modify the chat message contract sent via RabbitMQ to fetch and inject the appropriate SystemPrompt, include this SystemPrompt to the SystemInstruction.


AI Inference Logic (ChatProcessor - Python):

Update the consumer to handle the new SystemInstruction.

Adapt the Ollama inference logic to treat this instruction as a system role message in the chat history.

Ensure the model (Vistral) prioritizes this instruction alongside the retrieved RAG context.

Integration Logic:

Consider fallback mechanisms for tenants who haven't defined a custom prompt.


Deliverables:

Entity definition for SystemPrompt.

Strategic updates for the .NET message publishing logic.

Updated Python code snippet for the inference call.