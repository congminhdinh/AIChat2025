Role: Bạn là một Chuyên gia thiết kế hệ thống và Kiến trúc sư phần mềm. Nhiệm vụ của bạn là hỗ trợ tôi viết mục "4.2.2 Thiết kế lớp" cho đồ án tốt nghiệp với đề tài: "Ứng dụng Multi-tenant RAG để xây dựng website tra cứu, giải đáp luật và nội quy tùy biến cho từng doanh nghiệp".

Context:

Hãy đọc file class_analysis_4_1_3.md để hiểu ngữ cảnh hệ thống và danh sách các lớp đã phân tích sơ bộ.

Quét qua mã nguồn tôi cung cấp để lấy thông tin thực tế về các thuộc tính (attributes) và phương thức (methods).

Yêu cầu chi tiết:

1. Phân tích và lựa chọn lớp chủ đạo
Hãy chọn ra 3-4 lớp quan trọng nhất tập trung vào 2 luồng xử lý cốt lõi:

Luồng Cô lập Multi-tenant: (Ví dụ: TenantManager, TenantContextHolder, hoặc TenantInterceptor).

Luồng RAG (Retrieval-Augmented Generation): (Ví dụ: RAGService, VectorStoreService, DocumentProcessor).

Với mỗi lớp, hãy trình bày dưới dạng bảng hoặc danh sách bao gồm:

Tên lớp, các thuộc tính (kiểu dữ liệu), các phương thức (tham số truyền vào, kiểu trả về).

Diễn giải bằng tiếng Việt về vai trò của từng thuộc tính/phương thức trong kiến trúc Multi-tenant và RAG.

Lưu ý: Giữ nguyên tên lớp, hàm và thuộc tính theo đúng mã nguồn (tiếng Anh).

2. Thiết kế luồng truyền thông điệp (Sequence Diagram)
Sử dụng ngôn ngữ PlantUML để vẽ 2 biểu đồ trình tự cho 2 Use Case quan trọng nhất:

Use Case 1: Tải lên và xử lý tài liệu theo Tenant (Ingest Document): Thể hiện cách hệ thống tách biệt dữ liệu của từng doanh nghiệp khi đưa vào Vector Database.

Use Case 2: Truy vấn và giải đáp luật (Query/RAG Flow): Thể hiện cách hệ thống lấy tenant_id từ request, truy xuất đúng namespace/collection trong VectorDB và gọi LLM để trả lời.

Yêu cầu về biểu đồ:

Giữ nguyên tên lớp và hàm từ code.

Phần chú thích (Note) và lời nhắn trên mũi tên (Message) sử dụng tiếng Việt.

Đảm bảo tính logic: thể hiện rõ việc kiểm tra quyền truy cập của tenant.

3. Phong cách trình bày
Viết theo văn phong học thuật, chuyên nghiệp dành cho đồ án tốt nghiệp.

Độ dài dự kiến sau khi chuyển đổi sang Word khoảng 3-4 trang.